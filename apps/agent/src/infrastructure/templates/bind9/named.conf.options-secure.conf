// BIND9 DNS Server Options with Security - Generated by ServerFlow
// Do not edit manually - changes will be overwritten

options {
    directory "/var/cache/bind";

    {{#if forwarders}}
    // Forward queries to upstream DNS servers
    forwarders {
        {{#each forwarders}}
        {{ this }};
        {{/each}}
    };
    forward {{ forwardMode | default:only }};
    {{/if}}

    // DNSSEC validation
    dnssec-validation auto;

    // Listen on interfaces
    listen-on { {{ listenOn | default:any }}; };
    listen-on-v6 { {{ listenOnV6 | default:any }}; };

    // Query access control
    allow-query { {{ allowQuery | default:any }}; };

    // Recursion settings
    recursion {{ recursion | default:no }};
    {{#if recursion}}
    allow-recursion { {{ allowRecursion | default:localhost }}; };
    {{/if}}

    // Zone transfer restrictions
    allow-transfer { {{ allowTransfer | default:none }}; };

    {{#if rrl}}
    // Response Rate Limiting (RRL) - DDoS protection
    rate-limit {
        responses-per-second {{ rrlResponsesPerSecond | default:5 }};
        window {{ rrlWindow | default:15 }};
        log-only no;
    };
    {{/if}}

    // Version hiding for security
    version "not disclosed";

    // Disable recursion on authoritative server
    {{#unless cacheMode}}
    minimal-responses yes;
    {{/unless}}
};

{{#if logging}}
// Query logging for audit/debug
logging {
    channel query_log {
        file "/var/log/named/query.log" versions 3 size 10m;
        severity info;
        print-time yes;
        print-category yes;
    };
    category queries { query_log; };
};
{{/if}}
