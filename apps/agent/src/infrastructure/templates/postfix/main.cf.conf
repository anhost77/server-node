# Postfix Main Configuration - Generated by ServerFlow
# Appended to existing configuration

# Basic settings
myhostname = {{ hostname }}
mydomain = {{ domain }}
myorigin = $mydomain
mydestination = $myhostname, localhost.$mydomain, localhost
mynetworks = {{ mynetworks | default:127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 }}

# TLS parameters
smtpd_tls_cert_file={{ tls_cert | default:/etc/ssl/certs/ssl-cert-snakeoil.pem }}
smtpd_tls_key_file={{ tls_key | default:/etc/ssl/private/ssl-cert-snakeoil.key }}
smtpd_tls_security_level=may
smtp_tls_security_level=may

# SASL authentication
smtpd_sasl_type = dovecot
smtpd_sasl_path = private/auth
smtpd_sasl_auth_enable = yes

# Restrictions
smtpd_recipient_restrictions =
    permit_mynetworks,
    permit_sasl_authenticated,
    reject_unauth_destination,
    reject_rbl_client zen.spamhaus.org

# Mailbox
home_mailbox = Maildir/

# Size limits
message_size_limit = {{ message_size_limit | default:52428800 }}
mailbox_size_limit = {{ mailbox_size_limit | default:0 }}

# Virtual domains (uncomment and configure as needed)
# virtual_mailbox_domains = /etc/postfix/virtual_domains
# virtual_mailbox_base = /var/mail/vhosts
# virtual_mailbox_maps = hash:/etc/postfix/vmailbox
# virtual_alias_maps = hash:/etc/postfix/virtual
